<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>执法依据</title>
    <style>
        .scroll_table_content{
            width:100%;
            height:600px;
            overflow:auto;
        }
    </style>
</head>
<body class="container-fluid">
<ul id="myTab" class="nav nav-tabs" >
    <li  id="Confli1" >
        <a href="#Conf1" data-toggle="tab" >
            执法依据
        </a>
    </li>
    <li id="Confli2"><a href="#Conf2" data-toggle="tab">执法依据来源</a></li>
    <li id="Confli3"><a href="#Conf3" data-toggle="tab">执法库</a></li>
    <li id="Confli4"><a href="#Conf4" data-toggle="tab">执法条款清单</a></li>
</ul>
<div id="myTabContent" class="tab-content">
    <div class="tab-pane" id="Conf1">
        <div class="container-fluid">
            <form id="mForm" class="form-horizontal" role="form" enctype="application/x-www-form-urlencoded" method="post" action="{:U('CheckBaseMng/AddCheck')}">
                <div class="alert alert-info" role="alert" style="margin-top: 10px;">
                    <div class=""><strong>提示：</strong>执法依据添加与管理。</div>
                </div>
                <div class="form-group">
                    <div class="col-sm-offset-0 col-sm-12">
                        <neq name="Warning" value="">
                            <div class="alert alert-warning" role="alert"><strong>提示：</strong>{$Warning}</div>
                        </neq>
                    </div>
                </div>
                <div class="col-sm-10 col-sm-offset-1">
                    <div style="margin-top: 10px">
                        <div class="form-group">
                            <div class="form-inline">
                                <label class="col-sm-2 control-label">执法库:</label>
                                    <div class="col-sm-offset-2"  >
                                       <div id="CBoxParent" style="margin-left: 5px;">
                                            <input type="hidden" name="CurCheckDBS" id="CurCheckDBSInput" value=""/>
                                       </div>
                                    </div>

                            </div>

                            <div style="margin-top: 15px">
                                <label class="col-sm-2 control-label" >来源类型:</label>
                                <div class="col-sm-3">
                                    <input name="MdfID" id="MdfID" type="hidden" value="{$MdfID}"/>
                                    <select class="form-control" name="CheckSourceType" id="CheckSourceTypeSel">
                                        <volist name="CheckSourceType_ret" id="vo">
                                            <option value="{$vo.SourceTypeName}">
                                                {$vo.SourceTypeName}
                                            </option>
                                            </tr>
                                        </volist>
                                    </select>
                                </div>
                            </div>


                            <div class="col-sm-2" style="width: 100px;">
                                <label class="control-label">来源名称:</label>
                            </div>
                            <div class="col-sm-3">
                                <select class="form-control" name="CheckSource" id="CheckSourceSel">
                                    <volist name="CheckSource_ret" id="vo">
                                        <option value="{$vo.CheckSource}">
                                            {$vo.CheckSource}
                                        </option>
                                        </tr>
                                    </volist>
                                </select>
                             </div>
                            <input type="hidden" class="form-control" id="IN"/>
                            <a id="showInput" class="btn btn-warning">+</a>
                        </div>
                        <div class="form-group ">
                            <label for=""  class="col-sm-2 control-label">检查项目:</label>
                            <div class="col-sm-8">
                                    <input  name= "CheckSubject" class="form-control"  value="{$CheckSubject}"/>
                            </div>
                        </div>

                        <div class="form-group">
                            <label  class="col-sm-2 control-label">检查内容:</label>
                            <div class="col-sm-8">
                                <textarea type="text"  name="CheckContent" rows=6 class="form-control"   placeholder="" >{$CheckContent}</textarea>
                            </div>



                        </div>

                        <div class="form-group">
                            <label  class="col-sm-2 control-label">检查标准:</label>
                            <div class="col-sm-8">
                                <textarea type="text" name="CheckStandard" rows=6 class="form-control"  placeholder="" >{$CheckStandard}</textarea>
                            </div>



                        </div>
                        <div class="form-group">
                            <label  class="col-sm-2 control-label">符合性判定标准:</label>
                            <div class="col-sm-8">
                                <textarea type="text" name="CheckConfirmStd" rows=6 class="form-control"  placeholder="" >{$CheckConfirmStd}</textarea>
                            </div>



                        </div>


                        <div class="form-group">
                            <label  class="col-sm-2 control-label">操作:</label>
                            <div class="col-sm-2 col-sm-offset-1">
                                <button  class="btn btn-success">添加</button>
                            </div>
                            <div class="col-sm-2">
                                <a class="btn btn-info" href="#" RXDBtn >修订</a>
                            </div>
                            <div class="col-sm-2">
                                <button  class="btn btn-primary">查询</button>
                            </div>
                        </div>
                    </div>
                </div>
             </form>

        </div>
    </div>
    <div class="tab-pane" id="Conf2">
        <div class="container-fluid" style="margin-top:30px">
            <form class="form-horizontal" id="CheckSourceAddFrm" role="form" enctype="multipart/form-data" method="post" action="{:U('CheckBaseMng/AddCheckBaseSource')}">
                <div class="alert alert-info" role="alert" style="margin-top: 10px;"><div class="col-sm-offset-0"><strong>提示：执法依据来源类型的添加与管理。</strong></div></div>
                <input type="hidden" name="selInput" id="selInput"/>
                <div style="margin-top: 10px">
                    <div class="form-group">
                        <div class="col-sm-12">
                            <neq name="WarningRight" value="">
                                <div class="alert alert-danger" role="alert"><strong>提示：</strong>{$WarningRight}</div>
                            </neq>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-sm-1"></div>
                        <label for="Name" class="col-sm-2 control-label">执法依据来源类型:</label>

                        <div class="col-sm-6">
                            <input class="form-control" type="text" id="Name" name="Name"  placeholder="请写全称" />
                        </div>
                        <button type="submit" class="btn btn-primary">添加</button>
                    </div>
                <hr/>
                <table class="table table-striped table-bordered bootstrap-datatable datatable responsive">
                <thead>
                <tr>
                    <th>序号</th>
                    <th>依据来源类型</th>
                    <th>操作</th>
                </tr>
                </thead>
                <tbody>
                <volist name="CheckSourceType_ret" id="vo">
                    <tr>
                        <td>
                            {$vo.id}
                        </td>
                        <td>
                            {$vo.SourceTypeName}
                        </td>
                        <td>
                            <input type="checkbox" name="CKbtn" CKid = "{$vo.id}" style="margin-right: 10px;"/><a class="btn btn-danger btn-sm" href="#" BtnID = "{$vo.id}"  disabled>删除</a>
                        </td>
                    </tr>
                </volist>
                </tbody>
                </table>
            </div>
            </form>

        </div>
    </div>
    <div class="tab-pane" id="Conf3">
        <div class="container-fluid" style="margin-top:30px">
            <form class="form-horizontal" id="CheckBaseDBFrm" role="form" enctype="multipart/form-data" method="post" action="{:U('CheckBaseMng/AddCheckDB')}">
                <div class="alert alert-info" role="alert" style="margin-top: 10px;"><div class="col-sm-offset-0"><strong>提示：</strong>执法库管理。</div></div>
                <input type="hidden" name="selInput" id=""/>
                <div style="margin-top: 10px">
                    <div class="form-group">
                        <div class="col-sm-12">
                            <neq name="WarningRight" value="">
                                <div class="alert alert-danger" role="alert"><strong>提示：</strong>{$WarningRight}</div>
                            </neq>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-sm-1"></div>
                        <label for="Name" class="col-sm-2 control-label">执法库名称:</label>

                        <div class="col-sm-6">
                            <input class="form-control" type="text" name="CheckBaseDBName"  placeholder="请写全称" />
                        </div>
                        <button type="submit" class="btn btn-primary">添加</button>
                    </div>
                    <hr/>
                    <table class="table table-striped table-bordered bootstrap-datatable datatable responsive">
                        <thead>
                        <tr>
                            <th>序号</th>
                            <th>执法库名称</th>
                            <th>操作</th>
                        </tr>
                        </thead>
                        <tbody>
                        <volist name="CheckBaseDB_ret" id="vo">
                            <tr>
                                <td>
                                    {$vo.id}
                                </td>
                                <td>
                                    {$vo.DBName}
                                </td>
                                <td>
                                    <input type="checkbox" name="CKbtn" CKid = "{$vo.id}" style="margin-right: 10px;"/><a class="btn btn-danger btn-sm" href="#" BtnID = "{$vo.id}"  disabled>删除</a>
                                </td>
                            </tr>
                        </volist>
                        </tbody>
                    </table>
                </div>
            </form>
        </div>

        </div>
        <div class="tab-pane" id="Conf4">
            <div class="container-fluid" style="margin-top:30px">
                <form class="form-horizontal" id="" role="form" enctype="multipart/form-data" method="post" action="{:U('CheckBaseMng/AddCheckDB')}">

                <div class="" style="overflow:scroll; width:100%; height:800px;">
            <table data-toggle="table"
                   data-toolbar="#toolbar"
                   data-search="true"
                   data-show-refresh="true"
                   data-show-toggle="true"
                   data-show-columns="true"
                   data-show-export="true"
                   data-minimum-count-columns="2"
                   data-id-field="id"
                   data-show-footer="false"
                   data-classes="table table-bordered"
                   data-response-handler="responseHandler"
                   style="min-width:  150%;"
                   class="table  bootstrap-datatable datatable  table-bordered responsive table-hover"
            >
                <thead>
                <tr>
                    <th >序号</th>
                    <th class="col-sm-1">类型</th>
                    <th class="col-sm-1">所在库</th>
                    <th class="col-sm-1">来源</th>
                    <th class="col-sm-1">项目</th>
                    <th class="col-sm-2">内容</th>
                    <th class="col-sm-3">标准</th>
                    <th class="col-sm-4">符合性判定标准</th>
                    <th >修订</th>
                    <th >删除</th>
                </tr>
                </thead>
                <tbody>
                <volist name="Check_ret" id="vo">
                    <tr>
                        <td>
                            {$vo.id}
                        </td>
                        <td>
                            {$vo.CheckSourceType}
                        </td>
                        <td>
                            {$vo.BelongDBs}
                        </td>
                        <td>
                            {$vo.CheckSource}
                        </td>
                        <td>
                            {$vo.CheckSubject}
                        </td>
                        <td>
                            {$vo.CheckContent}
                        </td>
                        <td>
                            {$vo.CheckStandard}
                        </td>
                        <td>
                            {$vo.CheckConfirmStd}
                        </td>
                        <td>
                            <a class="btn btn-info btn-sm" href="#" XDBtnID = "{$vo.id}"  >修订</a>
                        </td>
                        <td>
                            <a class="btn btn-danger btn-sm" href="#" BtnID = "{$vo.id}" >删除</a>
                        </td>
                    </tr>
                </volist>
                </tbody>
            </table>
        </div>
                </form>
            </div>
        </div>
</div>

</body>
<script>
    $(function () {
        var CheckBaseDBs = {$CheckBaseDB|default=[]};
        var CurCheckDBs = {$CurCheckDBs|default=[]};
        var ActiveLi = "{$myActiveLi|default=Confli1}";
        var CurCheckSourceType = "{$CheckSourceType|default=''}";
        var CurCheckSource = "{$CheckSource|default=''}";
        $("li").removeClass("active");
        $("#" + ActiveLi).addClass("active");
        tgtTab = $("#" + ActiveLi + ">a").attr("href");
        $(tgtTab).addClass("fade  in active");
        $("#showInput").click(function () {
            var elem = document.getElementById('IN');
            dialog({
                title:'请输入来源名称!',
                content: '名称:<input id="DiagUserInput" class="form-control"/>',
                id: 'IN',
                button: [
                    {
                        value: '添加来源',
                        callback: function () {
                            var count = $("#CheckSourceSel option").length;
                            var val =$("#DiagUserInput").val(),bFind=0;
                            for ( var i = 0; i < count; i++) {
                               if($("#CheckSourceSel ").get(0).options[i].value==val){
                                   bFind = 1;
                               }
                            }
                            if(bFind==0){
                                $("#CheckSourceSel ").append("<option>"+val+"</option>");
                            }
                        },
                        autofocus: true
                    },
                    {
                        value: '退出',
                        callback: function () {
                            close();
                        }
                    }
                    ]
            }).showModal();
        });
        $("a[XDBtnID]").click(function () {
            window.location = "{:U('CheckBaseMng/showMdfInfo')}" + "&id="+$(this).attr("XDBtnID");
        });
        $("a[RXDBtn]").click(function () {
           $("#mForm").attr("action", "{:U('CheckBaseMng/MdfCheck')}" + "&id="+$("#MdfID").val()) ;
           $("#mForm").submit();
        });

        for(i =0;i<CheckBaseDBs.length;i++){
            $("#CBoxParent").append('<div class="checkbox" style="margin-left: 10px;"><label ><input type="checkbox" DBCBox value="'+CheckBaseDBs[i]+'"> '+CheckBaseDBs[i]+'</label></div>');
        }


        for(j=0;j<CurCheckDBs.length;j++){
                $('input[value="'+CurCheckDBs[j]+'"]').prop("checked","checked");
                //alert(CurCheckDBs[j]);
        }


        $("input[DBCBox]").click(function () {
            var DBS = '';
            var isToDEL= false;
            if($(this).is(":checked")){
                CurCheckDBs.push($(this).val());
            }else{
                isToDEL =true;
            }

            for(i=0;i<CurCheckDBs.length;i++){
                if(isToDEL && CurCheckDBs[i]==$(this).val() ){
                    CurCheckDBs.splice(i,1);
                    i--;
                }else{
                    if(DBS==''){
                        DBS = CurCheckDBs[i] ;
                    }else{
                        DBS += '|' + CurCheckDBs[i];
                    }
                }
            }

            $("#CurCheckDBSInput").val(DBS);
        });
        $("#CheckSourceTypeSel option[value="+CurCheckSourceType+"]").attr("selected", true);
        $("#CheckSource option[value="+CurCheckSource+"]").attr("selected", true);
    });
</script>
</html>