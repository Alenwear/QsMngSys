<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>检查单管理</title>

</head>
<body class="container-fluid">
<ul id="myTab" class="nav nav-tabs" >
    <li  id="Confli1" >
        <a href="#Conf1" data-toggle="tab" >
            检查单生成
        </a>
    </li>
    <li id="Confli2">
        <a href="#Conf2" data-toggle="tab">
            检查单管理
        </a>
    </li>
</ul>
<div id="myTabContent" class="tab-content">
    <div class="tab-pane" id="Conf1">
        <div class="container-fluid">
            <form id="mForm" class="form-horizontal" role="form" enctype="application/x-www-form-urlencoded" method="post" action="{:U('CheckBaseMng/AddCheck')}">
                <div class="alert alert-info" role="alert" style="margin-top: 10px;">
                    <div class=""><strong>提示：</strong>根据执法依据生成检查单。</div>
                </div>
                <div class="form-group">
                    <div class="col-sm-offset-0 col-sm-12">
                        <neq name="Warning" value="">
                            <div class="alert alert-warning" role="alert"><strong>提示：</strong>{$Warning}</div>
                        </neq>
                    </div>
                </div>


                    <div class="form-group">

                        <div class="">
                            <label class="control-label col-sm-1" for="MdfID">来源类型:</label>
                            <div class="col-sm-2">
                                <input name="MdfID" id="MdfID" type="hidden" value="{$MdfID}"/>
                                <select class="form-control" name="CheckSourceType" id="CheckSourceTypeSel">
                                    <option></option>
                                    <volist name="CheckSourceType_ret" id="vo">
                                        <option value="{$vo.SourceTypeName}">
                                            {$vo.SourceTypeName}
                                        </option>
                                        </tr>
                                    </volist>
                                </select>
                            </div>
                        </div>
                        <div class="">
                            <div class="" >
                                <label class="control-label col-sm-1" for="CheckSourceSel">来源名称:</label>
                            </div>
                            <div class="col-sm-2">
                                <select class="form-control" name="CheckSource" id="CheckSourceSel">
                                    <option></option>
                                    <volist name="CheckSource_ret" id="vo">
                                        <option value="{$vo.CheckSource}">
                                            {$vo.CheckSource}
                                        </option>
                                        </tr>
                                    </volist>
                                </select>
                            </div>
                        </div>
                        <div class="">
                            <div class="" >
                                <label class="control-label col-sm-1" for="CheckSubjectSel">检查项目:</label>
                            </div>
                            <div class="col-sm-2">
                                <select class="form-control" name="" id="CheckSubjectSel">
                                    <option></option>
                                    <volist name="CheckSubject_ret" id="vo">
                                        <option value="{$vo.CheckSubject}">
                                            {$vo.CheckSubject}
                                        </option>
                                        </tr>
                                    </volist>
                                </select>
                            </div>
                        </div>
                            <a id="showInput" class="btn btn-warning">筛选</a>
                            <a id="" class="btn btn-success">检查单预览</a>
                    </div>
              <hr/>

                <div class="col-sm-12">
                    <table class="table  bootstrap-datatable datatable  table-bordered responsive table-hover">
                        <thead>
                        <tr>
                            <th >序号</th>
                            <th >类型</th>
                            <th>来源</th>
                            <th >项目</th>
                            <th >内容</th>
                            <th class="col-sm-4">标准</th>
                            <th class="col-sm-4">符合性判定标准</th>
                            <th >加入</th>
                            <th >状态</th>
                        </tr>
                        </thead>
                        <tbody>
                        <volist name="Check_ret" id="vo">
                            <tr>
                                <td>
                                    {$vo.id}
                                </td>
                                <td>
                                    {$vo.CheckSourceType}
                                </td>
                                <td>
                                    {$vo.CheckSource}
                                </td>
                                <td>
                                    {$vo.CheckSubject}
                                </td>
                                <td>
                                    {$vo.CheckContent}
                                </td>
                                <td>
                                    {$vo.CheckStandard}
                                </td>
                                <td>
                                    {$vo.CheckConfirmStd}
                                </td>
                                <td>
                                    <a class="btn btn-default btn-sm" href="#" XDBtnID = "{$vo.id}"  >加入</a>
                                </td>
                                <td>

                                </td>
                            </tr>
                        </volist>
                        </tbody>
                    </table>
                </div>

            </form>

        </div>
    </div>
    <div class="tab-pane" id="Conf2">
        <div class="container-fluid" style="margin-top:30px">
            <form class="form-horizontal" id="CheckSourceAddFrm" role="form" enctype="multipart/form-data" method="post" action="{:U('CheckBaseMng/AddCheckBaseSource')}">
                <div class="alert alert-info" role="alert" style="margin-top: 10px;"><div class="col-sm-offset-0"><strong>提示：</strong>检查单管理。</div></div>
                <input type="hidden" name="selInput" id="selInput"/>
                <div style="margin-top: 10px">
                    <div class="form-group">
                        <div class="col-sm-12">
                            <neq name="WarningRight" value="">
                                <div class="alert alert-danger" role="alert"><strong>提示：</strong>{$WarningRight}</div>
                            </neq>
                        </div>
                    </div>

                    <div class="form-group">
                        <div class="col-sm-1"></div>
                        <label for="Name" class="col-sm-2 control-label">执法依据来源类型:</label>

                        <div class="col-sm-6">
                            <input class="form-control" type="text" id="Name" name="Name"  placeholder="请写全称" />
                        </div>
                        <button type="submit" class="btn btn-primary">添加</button>
                    </div>
                    <hr/>
                    <table class="table table-striped table-bordered bootstrap-datatable datatable responsive">
                        <thead>
                        <tr>
                            <th>序号</th>
                            <th>依据来源类型</th>
                            <th>操作</th>
                        </tr>
                        </thead>
                        <tbody>
                        <volist name="CheckSourceType_ret" id="vo">
                            <tr>
                                <td>
                                    {$vo.id}
                                </td>
                                <td>
                                    {$vo.SourceTypeName}
                                </td>
                                <td>
                                    <input type="checkbox" name="CKbtn" CKid = "{$vo.id}" style="margin-right: 10px;"/><a class="btn btn-danger btn-sm" href="#" BtnID = "{$vo.id}"  disabled>删除</a>
                                </td>
                            </tr>
                        </volist>
                        </tbody>
                    </table>
                </div>
            </form>


        </div>
    </div>
</div>

</body>
<script>
    $(function () {
        var ActiveLi = "{$myActiveLi|default=Confli1}";
        var CurCheckSourceType = "{$CheckSourceType|default=''}";
        var CurCheckSource = "{$CheckSource|default=''}";
        $("li").removeClass("active");
        $("#" + ActiveLi).addClass("active");
        tgtTab = $("#" + ActiveLi + ">a").attr("href");
        $(tgtTab).addClass("fade  in active");
        $("#showInput").click(function () {
            var elem = document.getElementById('IN');
            dialog({
                title:'请输入来源名称!',
                content: '名称:<input id="DiagUserInput" class="form-control"/>',
                id: 'IN',
                button: [
                    {
                        value: '添加来源',
                        callback: function () {
                            var count = $("#CheckSourceSel option").length;
                            var val =$("#DiagUserInput").val(),bFind=0;
                            for ( var i = 0; i < count; i++) {
                                if($("#CheckSourceSel ").get(0).options[i].value==val){
                                    bFind = 1;
                                }
                            }
                            if(bFind==0){
                                $("#CheckSourceSel ").append("<option>"+val+"</option>");
                            }
                        },
                        autofocus: true
                    },
                    {
                        value: '退出',
                        callback: function () {
                            close();
                        }
                    }
                ]
            }).showModal();
        });
        $("a[XDBtnID]").click(function () {
            window.location = "{:U('CheckBaseMng/showMdfInfo')}" + "&id="+$(this).attr("XDBtnID");
        });
        $("a[RXDBtn]").click(function () {
            $("#mForm").attr("action", "{:U('CheckBaseMng/MdfCheck')}" + "&id="+$("#MdfID").val()) ;
            $("#mForm").submit();
        });
        $("#CheckSourceTypeSel option[value="+CurCheckSourceType+"]").attr("selected", true);
        $("#CheckSource option[value="+CurCheckSource+"]").attr("selected", true);
    });
</script>
</html>